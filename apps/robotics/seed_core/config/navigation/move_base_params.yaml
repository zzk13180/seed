# ================================================================================
# 文件名: move_base_params.yaml
# 描  述: move_base 导航栈核心参数配置
#
# 功能说明:
#   此配置文件定义 move_base 节点的核心运行参数，包括:
#     - 全局/局部路径规划器选择
#     - 规划频率和超时设置
#     - 恢复行为配置
#
# 参考文档:
#   - Navigation 官方介绍: http://wiki.ros.org/navigation/Tutorials
#   - move_base 官方介绍: http://wiki.ros.org/move_base
#
# 作者: Seed Robotics Team
# 版本: 2.0.0
# ================================================================================

# ================================================================================
# 路径规划器选择
# ================================================================================

# 全局路径规划器
# 可选值:
#   - "global_planner/GlobalPlanner": 使用 A* 或 Dijkstra 算法（推荐）
#   - "navfn/NavfnROS": 经典导航函数规划器
#   - "carrot_planner/CarrotPlanner": 简单的直线规划器
base_global_planner: "global_planner/GlobalPlanner"

# 局部路径规划器
# 可选值:
#   - "teb_local_planner/TebLocalPlannerROS": 时间弹性带规划器（推荐）
#   - "dwa_local_planner/DWAPlannerROS": 动态窗口法规划器
# 注意: 局部规划器会在 teb_local_planner.launch 中重新设置
base_local_planner: "teb_local_planner/TebLocalPlannerROS"

# ================================================================================
# 规划频率配置
# ================================================================================

# 控制器频率（Hz）
# 控制发布速度命令到 cmd_vel 话题的频率
# 建议值: 5-20 Hz，越高响应越快但计算负载越大
controller_frequency: 10.0

# 全局规划器频率（Hz）
# 重新规划全局路径的频率
# 设置为 0 表示仅在设置新目标时规划一次
# 建议值: 0-2 Hz
planner_frequency: 1.0

# 最大规划重试次数
# 规划失败后重试的次数，-1 表示无限重试
max_planning_retries: 1

# ================================================================================
# 代价地图管理
# ================================================================================

# 是否在非活动状态时关闭代价地图更新
# 设置为 true 可以节省 CPU，但重新激活时需要时间恢复
shutdown_costmaps: false

# ================================================================================
# 恢复行为配置
# ================================================================================

# 恢复行为列表
# 当导航失败时按顺序执行这些恢复策略
recovery_behaviors:
  # 恢复行为 1: 清除代价地图
  # 清除障碍物层中的动态障碍物，保留静态地图
  - name: "recovery_behavior_1"
    type: "clear_costmap_recovery/ClearCostmapRecovery"
  
  # 恢复行为 2: 缓慢移动并清除
  # 机器人缓慢移动一段距离，同时清除代价地图
  - name: "recovery_behavior_2"
    type: "move_slow_and_clear/MoveSlowAndClear"

# 是否启用恢复行为
# 建议在实际部署中启用，可以帮助机器人脱困
recovery_behavior_enabled: true

# 是否允许旋转清除
# 在恢复过程中允许机器人原地旋转以清除障碍物
# 仅在使用默认恢复行为时有效
clearing_rotation_allowed: false

# 保守重置距离（米）
# 执行恢复行为时，清除与机器人此距离外的障碍物
# 仅在使用默认恢复行为时有效
conservative_reset_dist: 3.0

# ================================================================================
# 超时配置
# ================================================================================

# 规划器超时（秒）
# 规划失败多长时间后执行恢复行为
planner_patience: 5.0

# 控制器超时（秒）
# 未收到有效控制命令多长时间后执行恢复行为
controller_patience: 15.0

# ================================================================================
# 振荡检测
# ================================================================================

# 振荡检测距离（米）
# 当机器人移动幅度小于此值时认为处于振荡状态
oscillation_distance: 0.05

# 振荡超时（秒）
# 振荡持续多久后执行恢复行为
oscillation_timeout: 10.0

# ================================================================================
# 恢复行为详细参数
# ================================================================================

# 恢复行为 1: 清除代价地图恢复
recovery_behavior_1:
  # 重置距离（米）
  # 清除与机器人此距离外的障碍物
  # 设置为 0 表示清除所有动态障碍物
  reset_distance: 0.0

# 恢复行为 2: 缓慢移动清除
recovery_behavior_2:
  # 清除距离（米）
  # 清除以机器人为中心此半径外的障碍物
  clearing_distance: 0.5
  
  # 限制线速度（米/秒）
  # 恢复行为期间的最大线速度
  limited_trans_speed: 0.15
  
  # 限制角速度（弧度/秒）
  # 恢复行为期间的最大角速度
  limited_rot_speed: 0.3
  
  # 限制移动距离（米）
  # 完成恢复行为必须移动的最小距离
  limited_distance: 0.3
  
  # 规划器命名空间
  # 指定使用的局部规划器
  planner_namespace: TebLocalPlannerROS
  
  # 最大速度参数名称
  max_trans_param_name: max_vel_x
  max_rot_param_name: max_vel_theta
